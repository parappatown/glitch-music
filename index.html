<html>
<head>
	<title></title>
	<style>

		button {
			outline: 0;
			padding: 20px;
			border-radius: 10px;
			border: 0;
			background-color: #00dd00;
			border: 4px solid #00dd00;

			transition: 0.5s;
		}

		button:hover {
			background-color: #00ff00;
		}

		button.active {
			border: 4px solid blue;
		}

		button.stop {
			background-color: #ebebeb;
		}

		.percussion button {
			background-color: #eee;
		}

		.percussion button.active {
			background-color: orange;
		}

	</style>
</head>
<body>

	<textarea class="master"></textarea>

	<p>Random range</p>
	<input class="random-range" type="range" min="0" max="200"/>
	<span class="random-range-value"></span>

	<p>Frequency (millis)</p>
	<input class="frequency" type="range" min="10" max="200"/>
	<span class="frequency-value"></span>

	<br/>

	<div class="keyboard">
		<button class="A">A</button>
		<button class="B">B</button>
		<button class="C">C</button>
		<button class="D">D</button>
		<button class="E">E</button>
		<button class="F">F</button>
		<button class="G">G</button>
		<button class="A2">A2</button>
	</div>

	<br/>

	<audio id="clav" controls preload>
		<source src="sound/cr8kclav.mp3" type="audio/mpeg">
		<source src="sound/cr8kclav.wav" type="audio/wav">
		<source src="sound/cr8kclav.ogg" type="audio/ogg">
	</audio>

	<audio id="hat" controls preload>
		<source src="sound/cr8khat.mp3" type="audio/mpeg">
		<source src="sound/cr8khat.wav" type="audio/wav">
		<source src="sound/cr8khat.ogg" type="audio/ogg">
	</audio>

	<audio id="hit" controls preload>
		<source src="sound/cr8khit.mp3" type="audio/mpeg">
		<source src="sound/cr8khit.wav" type="audio/wav">
		<source src="sound/cr8khit.ogg" type="audio/ogg">
	</audio>

	<div class="percussion">
		<button class="clav">CLAV</button>
		<button class="hat">HAT</button>
		<button class="hit">HIT</button>
	</div>

	<br/>
	<button class="percussion-all">PLAY ALL PERCUSSION</button>
	<button class="stop">STOP</button>

	<br/>
	<br/>
	<br/>

	<script src="jquery.js"></script>
	<script src="glitch.js"></script>

	<script>

		var clav = document.getElementById('clav');
		clav.addEventListener('ended', function() {
			this.currentTime = 0;
			this.play();
		});

		var hat = document.getElementById('hat');
		hat.addEventListener('ended', function() {
			this.currentTime = 0;
			this.play();
		});


		var hit = document.getElementById('hit');
		hat.addEventListener('ended', function() {
			this.currentTime = 0;
			this.play();
		});

		// hat.volume = 0.6;
		// hit.volume = 0.6;
		// clav.volume = 0.6;

		// hat.play();

		$('.percussion-all').on('click', function() {
			hat.play();
			clav.play();
			hit.play();
			$('.master').focus();
		});

		var keyboard = {
			'A': A
		  , 'B': B
		  , 'C': C
		  , 'D': D
		  , 'E': E
		  , 'F': F
		  , 'G': G
		  , 'A2': A2
		};

		$('.percussion .clav').on('click', function() {
			$(this).toggleClass('active');

			if ($(this).hasClass('active')) {
				clav.play();
			}
			else {
				clav.pause();
			}
			$('.master').focus();
		})

		$('.percussion .hat').on('click', function() {
			$(this).toggleClass('active');

			if ($(this).hasClass('active')) {
				hat.play();
			}
			else {
				hat.pause();
			}
			$('.master').focus();
		})

		var stopSounds = function() {
			glitcher.clear();
			for (var i = 0; i < notes.length; i++) {
				notes[i].stop();
			}
			$('.keyboard button').removeClass('active');

			hat.pause();
			clav.pause();
		};

		$('.stop').on('click', function() {
			stopSounds();
			$('.master').focus();
		});

		$('.random-range').on('input', function() {
			var val = $(this).val();
			glitcher.setRandomRange(val / 100);
			$('.random-range-value').text(val / 100);
		});

		$('.frequency').on('input', function() {
			var val = $(this).val();
			glitcher.setTimer(val);
			$('.frequency-value').text(val);
		});

		$('.keyboard button').on('click', function() {
			var $button = $(this);
			$button.toggleClass('active');

			var note = keyboard[$button.text()];

			if ($button.hasClass('active')) {				
				note.play();
			}
			else {
				note.stop();
			}
			$('.master').focus();
		});

		$('.master').on('keydown', function(e) {
			var k = e.keyCode;

			if (k === 38) {
				console.log("UP");

				$(".A").click();
			}
			else if (k === 40) {
				console.log("DOWN");

				$(".C").click();
			}
			else if (k === 39) {
				console.log("RIGHT");
				$(".E").click();
			}
			else if (k === 37) {
				console.log("LEFT");
				$(".B").click();
			}
			else if (k === 32) {
				console.log("SPACE");
				$(".D").click();
			}
		});


		// A.play();
		// C.play();
		// G.play();

		glitcher.setTimer(100);


		$('.master').focus();

		// glitcher.setRandomRange(0.30);
		// glitcher.setRandomRange(0.50);



	</script>

</body>
</html>
